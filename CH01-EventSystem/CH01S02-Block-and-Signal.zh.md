# 阻塞与通知

凡事都有例外，在实现状态机时，有时会使用一些特殊的系统调用（SysCall），这些系统调用会导致阻塞（Block），从而不能及时返回到引擎中，例如：在NetHandler中调用epoll_wait会有阻塞产生。

如果引擎有后续任务需要执行，那么我们不可以在状态机中进行阻塞操作。
如果引擎没有后续任务要执行，那么我们可以在状态机中进行阻塞操作，在阻塞过程中，一旦引擎有了新任务需要执行，那么就需要立即中断阻塞，返回到引擎。

因此，在引擎中设计了通知机制，用来中断阻塞，同时通知状态机我们有了新任务。

所以，在实现状态机时需要遵循以下规则：

- 在需要阻塞／等待时，应当保存当前状态，然后返回到引擎
- 让引擎在下一个循环再驱动状态机继续执行
- 如果需要通过阻塞以获得更好的处理效果，则需要支持引擎的通知机制，在需要的时候及时返回引擎

接下来将详细讲述整个事件系统的构成与实现。
